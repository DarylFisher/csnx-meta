services:
  backend:
    build: ./backend
    ports:
      - "8000:8000"
    volumes:
      - ${GOOGLE_APPLICATION_CREDENTIALS:-./.empty}:/app/sa-key.json:ro
    environment:
      GOOGLE_APPLICATION_CREDENTIALS: /app/sa-key.json
      INSTANCE_CONNECTION_NAME: ${INSTANCE_CONNECTION_NAME:-}
      DB_USER: ${BACKEND_DB_USER:-}
      DB_PASS: ${BACKEND_DB_PASS:-}
      DB_NAME: ${BACKEND_DB_NAME:-}

  dashboard-api:
    build: ./dashboard-api
    ports:
      - "8001:8001"
    volumes:
      - ${GOOGLE_APPLICATION_CREDENTIALS:-./.empty}:/app/sa-key.json:ro
    environment:
      GOOGLE_APPLICATION_CREDENTIALS: /app/sa-key.json
      DATABASE_URL: ${DASHBOARD_DATABASE_URL:-}
      INSTANCE_CONNECTION_NAME: ${INSTANCE_CONNECTION_NAME:-}
      DB_USER: ${DB_USER:-}
      DB_PASS: ${DB_PASS:-}
      DB_NAME: ${DB_NAME:-}

  frontend:
    build: ./frontend
    ports:
      - "5173:5173"
    depends_on:
      - backend
      - dashboard-api
